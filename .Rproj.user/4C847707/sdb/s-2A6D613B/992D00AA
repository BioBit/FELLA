{
    "contents" : "\\documentclass{article}\n\\usepackage{amssymb}\n\\usepackage[usenames,dvipsnames]{xcolor}\n\\usepackage{longtable}\n\\usepackage{booktabs}\n\\usepackage[T1]{fontenc}\n\\usepackage{caption}\n\\usepackage[sc]{mathpazo}\n\\usepackage{float}\n\\usepackage{graphicx}\n\\usepackage[textwidth=17cm,textheight=24cm]{geometry}\n\n\\setlength\\parindent{0pt}\n\n\\usepackage{fancyhdr}\n\\pagestyle{fancy}\n\\fancyhead{}\n\\renewcommand{\\headrulewidth}{0pt}\n\\fancyhead[R]{\\small FEllA 0.99 automated report}\n\n\\makeatletter\n\\def\\strippt{\\strip@pt}\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.\n\\usepackage{rotating}\n\\makeatother\n\n\\begin{document}\n\n% \\captionsetup{labelformat=empty}\n<<setup, include=FALSE, cache=FALSE>>=\noptions(replace.assign = TRUE, width = 90)\n@\n\n\n\\title{FELLA v0.99 automated report}\n\\author{Sergio Picart-Armada \\qquad Alexandre Perera-Lluna \\\\ B2SLab at UPC}\n\\maketitle\n% \n% <<tableTest, results='asis', echo=FALSE>>=\n% test <- data.frame(x = 1:3, y = 1:3)\n% print(xtable(test, caption = '\\\\textbf{Test Table}', label = ''), \n%   caption.placement = getOption(\"xtable.caption.placement\", \"top\"), size = 'tiny')\n% @\n\n\\section{Input}\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\\subsection{Metabolites}\n\nThe user of this tool has completed a case-control experiment providing him with data about the \\textbf{affected compounds} between control and case populations. The specified metabolites are in table \\ref{tab:metaboliteInput}. Some of the metabolites may be excluded of the analysis because they are not within the metabolite background or the graph objects.\n\n<<tableInput, results='asis', echo=FALSE, resize.width=\"\\\\textwidth\", resize.height=\"\\\\textheight\">>=\ninput <- c(object@userinput@metabolites, object@userinput@excluded)\ninputNames <- sapply(input, function(id) {\n  data@keggdata@id2name[[id]][1]\n})\ninputUsage <- c(rep(\"Yes\", length(object@userinput@metabolites)), \n                rep(\"No\", length(object@userinput@excluded)))\n\nmetabolite.table <- cbind(input, inputNames, inputUsage)\ncolnames(metabolite.table) <- c(\"KEGG id\", \"Description\", \"Used in analysis\")\nrownames(metabolite.table) <- 1:dim(metabolite.table)[1]\n\nout <- xtable(metabolite.table, \n              caption = \"Affected metabolites, input for the enrichment\", \n              label = \"tab:metaboliteInput\")\nprint(out, \n      tabular.environment = \"longtable\", \n      floating = F)\n@\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\\subsection{Metabolite background}\n\nIn order to measure statistical significance, a reference background for the metabolites must be defined. Table \\ref{tab:metaboliteBackground} contains the essential data about it. This background can be ignored, thus using the default one, or can be user-defined.\n\n<<tableBackground, results='asis', echo=FALSE, message=F, resize.width=\"\\\\textwidth\", resize.height=\"\\\\textheight\">>=\n\nn.input <- length(object@userinput@metabolites)\nn.background <- length(object@userinput@metabolitesbackground)\nn.all <- length(data@keggdata@id$compound)\nif (n.background == 0) n.background <- n.all\n\nbackground.table <- matrix(c(n.input, n.background, n.all), ncol = 1)\ncolnames(background.table) <- \"Metabolites amount\"\nrownames(background.table) <- c(\"Input\", \"Background\", \"Whole graph\")\n\nprint(xtable(background.table, \n             caption = \"Metabolite background summary\", \n             label = \"tab:metaboliteBackground\"), \n      )\n@\n\n\\section{Results}\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\\subsection{Hypergeometric test}\n\nFor this test, the background can be smaller due to the fact that some compounds do not directly belong to any pathway. In particular, out of the original \n\\Sexpr{\nn.background <- length(object@userinput@metabolitesbackground)\nn.all <- length(data@keggdata@id$compound)\nif (n.background == 0) n.background <- n.all\nn.background\n} \nmetabolites, only \n\\Sexpr{object@hypergeom@nbackground} \nmetabolites have been included. Table \\ref{tab:HT} contains the top 15 pathways. Keep in mind that the connections used in this test are not the usual KEGG compound-pathway links, but they are inferred from the graph object.\n\\\\\n\n\\begin{table}[hl]\n\\resizebox{\\textwidth}{!}{\n<<tableHypergeom, results='asis', echo=FALSE, message=FALSE, resize.width=\"\\\\textwidth\", resize.height=\"\\\\textheight\">>=\n\nhypergeom.table <- generateResultsTable(method = \"hypergeom\", \n                                        threshold = 0.99, \n                                        plimit = 15, \n                                        object = object, \n                                        data = data)\n\nprint(xtable(x = hypergeom.table, \n             digits = c(0, 0, 0, 0, 0, 2), \n             display = c(\"d\", \"s\", \"s\", \"d\", \"d\", \"e\")\n             ), \n      floating = F)\n@\n}\n\\caption{Hypergeometric test p-values} \n\\label{tab:HT}\n\n\\end{table}\n\nThese results can be depicted using a bipartite graph containing the significant pathways and all the affected compounds belonging to them.\n\n\\begin{figure}[H]\n\\noindent\\makebox[\\textwidth]{\n\n<<graphHypergeom, fig.align=\"left\", results='hide', echo=FALSE, fig.width=12, fig.height=12, out.width=\"\\\\textwidth\">>=\nplot(x = object, \n     method = \"hypergeom\", \n     layout = F, \n     data = data)\n@\n}\n\\caption{Hypergeometric test results plotted as a bipartite graph.}\n\\label{fig:HT}\n\n\\end{figure}\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\\subsection{Heat diffusion model}\n\nThe eat diffusion model has been applied using the affected metabolites as sources. The resulting temperatures have been compared to a null distribution, which makes use of the background compounds. The relevant substructure is depicted in figure \\ref{fig:HD}. Table \\ref{tab:HD} contains the description and p-values for the drawn nodes. \n\n\\begin{figure}[H]\n\\noindent\\makebox[\\textwidth]{\n\n<<graphDiffusion, fig.align=\"left\", results='hide', echo=FALSE, fig.width=12, fig.height=12, out.width=\"\\\\textwidth\">>=\nplot(x = object, \n     method = \"diffusion\", \n     layout = F, \n     data = data)\n@\n}\n\\caption{Heat diffusion model results plotted as a graph. \n\\\\\n\\protect\\rule{\\textwidth}{.7pt}\nLegend: \\qquad {\\color{Maroon}Pathway} \\qquad {\\color{Orchid}Module} \\qquad {\\color{Dandelion}Enzyme} \\qquad {\\color{CornflowerBlue}Reaction} \\qquad {\\color{OliveGreen}Compound} \n\\\\\nShapes: \\qquad $\\square$ Metabolite in the input \\qquad $\\bigcirc$ Rest of the nodes\n\\\\\n\\protect\\rule{\\textwidth}{.7pt}\nThe nodes represented have statistical relevance in the experiment. Larger connected components suggest a stronger signal.}\n\\label{fig:HD}\n\n\\end{figure}\n\n\\newpage\n\n<<tableHD, results='asis', echo=FALSE, message=FALSE, resize.width=\"\\\\textwidth\", resize.height=\"\\\\textheight\">>=\ndiffusion.table <- generateResultsTable(method = \"diffusion\", \n                                        threshold = 0.001, \n                                        nlimit = 250, \n                                        object = object, \n                                        data = data)\n\nprint(xtable(x = diffusion.table, \n             digits = c(0, 0, 0, 0, 2), \n             display = c(\"d\", \"s\", \"s\", \"s\", \"e\"), \n             caption = \"Heat diffusion model entries and p-values. NULL names refer to entries without a name.\", \n             label = \"tab:HD\"\n             ), \n      tabular.environment = \"longtable\",\n      floating = F)\n@\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\\subsection{PageRank model}\n\nPageRank from igraph R package has been used to give each entry a score while taking into account the relevance of affected metabolites. The resulting scores have been compared to a null distribution, which makes use of the background compounds. The relevant substructure is depicted in figure \\ref{fig:PR}. Table \\ref{tab:PR} contains the description and p-values for the drawn nodes. \n\n\\begin{figure}[H]\n\\noindent\\makebox[\\textwidth]{\n\n<<graphPagerank, fig.align=\"left\", results='hide', echo=FALSE, fig.width=12, fig.height=12, out.width=\"\\\\textwidth\">>=\nplot(x = object, \n     method = \"pagerank\", \n     layout = F, \n     data = data)\n@\n}\n\\caption{PageRank model results plotted as a graph. \n\\newline\n\\protect\\rule{\\textwidth}{.7pt}\nLegend: \\qquad {\\color{Maroon}Pathway} \\qquad {\\color{Orchid}Module} \\qquad {\\color{Dandelion}Enzyme} \\qquad {\\color{CornflowerBlue}Reaction} \\qquad {\\color{OliveGreen}Compound} \n\\newline\nShapes: \\qquad $\\square$ Metabolite in the input \\qquad $\\bigcirc$ Rest of the nodes\n\\newline\n\\protect\\rule{\\textwidth}{.7pt}\nThe nodes represented have statistical relevance in the experiment. Larger connected components suggest a stronger signal.}\n\\label{fig:PR}\n\n\\end{figure}\n\n\\newpage\n\n<<tablePR, results='asis', echo=FALSE, message=FALSE, resize.width=\"\\\\textwidth\", resize.height=\"\\\\textheight\">>=\npagerank.table <- generateResultsTable(method = \"pagerank\", \n                                        threshold = 0.001, \n                                        nlimit = 250, \n                                        object = object, \n                                        data = data)\n\nprint(xtable(x = pagerank.table, \n             digits = c(0, 0, 0, 0, 2), \n             display = c(\"d\", \"s\", \"s\", \"s\", \"e\"), \n             caption = \"KEGG entries and p-values using PageRank model. NULL names refer to entries without a name.\", \n             label = \"tab:PR\"\n             ), \n      tabular.environment = \"longtable\",\n      floating = F)\n@\n\n\n\n\n\n\\end{document}",
    "created" : 1431067850197.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "283177685",
    "id" : "992D00AA",
    "lastKnownWriteTime" : 1431336313,
    "path" : "~/Rstuffbro/FEllA/data/report.Rnw",
    "project_path" : "data/report.Rnw",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "sweave"
}